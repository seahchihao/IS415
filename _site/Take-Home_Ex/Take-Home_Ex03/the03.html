<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Seah Chi Hao">
<meta name="dcterms.date" content="2024-11-02">

<title>Prototyping Modules for Geospatial Analytics Shiny Application [JB: The New Frontier?]</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../..//pictures/favicon.jpg" rel="icon" type="image/jpeg">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Chi Haoâ€™s IS415 Journey</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Overview</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-hands-on-exercise" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Hands-On Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-hands-on-exercise">    
        <li>
    <a class="dropdown-item" href="../../Hands-On_Ex/Hands-On_Ex01/hoe01.html">
 <span class="dropdown-text">Hands-On Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-On_Ex/Hands-On_Ex02/hoe02.html">
 <span class="dropdown-text">Hands-On Exercise 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-On_Ex/Hands-On_Ex03/hoe03.html">
 <span class="dropdown-text">Hands-On Exercise 3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-On_Ex/Hands-On_Ex05/hoe05.html">
 <span class="dropdown-text">Hands-On Exercise 5</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-On_Ex/Hands-On_Ex06/hoe06a.html">
 <span class="dropdown-text">Hands-On Exercise 6a</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-On_Ex/Hands-On_Ex06/hoe06b.html">
 <span class="dropdown-text">Hands-On Exercise 6b</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-On_Ex/Hands-On_Ex07/hoe07.html">
 <span class="dropdown-text">Hands-On Exercise 7</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-On_Ex/Hands-On_Ex08/hoe08.html">
 <span class="dropdown-text">Hands-On Exercise 8</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-On_Ex/Hands-On_Ex10/hoe10.html">
 <span class="dropdown-text">Hands-On Exercise 10</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-in-class-exercise" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">In-Class Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-in-class-exercise">    
        <li>
    <a class="dropdown-item" href="../../In-Class_Ex/In-Class_Ex02/ice02.html">
 <span class="dropdown-text">In-Class Exercise 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-Class_Ex/In-Class_Ex03/ice03.html">
 <span class="dropdown-text">In-Class Exercise 3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-Class_Ex/In-Class_Ex04/ice04.html">
 <span class="dropdown-text">In-Class Exercise 4</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-Class_Ex/In-Class_Ex05/ice05.html">
 <span class="dropdown-text">In-Class Exercise 5</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-Class_Ex/In-Class_Ex06/ice06.html">
 <span class="dropdown-text">In-Class Exercise 6</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-Class_Ex/In-Class_Ex09/ice09.html">
 <span class="dropdown-text">In-Class Exercise 9</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-Class_Ex/In-Class_Ex10/ice10.html">
 <span class="dropdown-text">In-Class Exercise 10</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-take-home-exercise" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Take-Home Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-take-home-exercise">    
        <li>
    <a class="dropdown-item" href="../../Take-Home_Ex/Take-Home_Ex01/the01.html">
 <span class="dropdown-text">Take-Home Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Take-Home_Ex/Take-Home_Ex02/the02.html">
 <span class="dropdown-text">Take-Home Exercise 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Take-Home_Ex/Take-Home_Ex03/the03.html">
 <span class="dropdown-text">Take-Home Exercise 3</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#overview" id="toc-overview" class="nav-link active" data-scroll-target="#overview">1.0 Overview</a>
  <ul class="collapse">
  <li><a href="#context" id="toc-context" class="nav-link" data-scroll-target="#context">1.1 Context</a></li>
  <li><a href="#objectives" id="toc-objectives" class="nav-link" data-scroll-target="#objectives">1.2 Objective(s)</a></li>
  <li><a href="#the-data-cleaned-and-processed" id="toc-the-data-cleaned-and-processed" class="nav-link" data-scroll-target="#the-data-cleaned-and-processed">1.3 The Data (cleaned and processed)</a></li>
  <li><a href="#point-of-interest-data-geospatial" id="toc-point-of-interest-data-geospatial" class="nav-link" data-scroll-target="#point-of-interest-data-geospatial">1.3.3 Point of Interest Data (Geospatial)</a></li>
  </ul></li>
  <li><a href="#setup" id="toc-setup" class="nav-link" data-scroll-target="#setup">2.0 Setup</a></li>
  <li><a href="#regression" id="toc-regression" class="nav-link" data-scroll-target="#regression">3.0 Regression</a>
  <ul class="collapse">
  <li><a href="#simple-linear-regression" id="toc-simple-linear-regression" class="nav-link" data-scroll-target="#simple-linear-regression">3.1 Simple Linear Regression</a></li>
  <li><a href="#multiple-linear-regression" id="toc-multiple-linear-regression" class="nav-link" data-scroll-target="#multiple-linear-regression">3.2 Multiple Linear Regression</a></li>
  </ul></li>
  <li><a href="#proposed-shiny-application-user-interface-storyboard" id="toc-proposed-shiny-application-user-interface-storyboard" class="nav-link" data-scroll-target="#proposed-shiny-application-user-interface-storyboard">4.0 Proposed Shiny Application User Interface Storyboard</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Prototyping Modules for Geospatial Analytics Shiny Application [JB: The New Frontier?]</h1>
<p class="subtitle lead">Take-home Exercise 03</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Seah Chi Hao </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">November 2, 2024</p>
    </div>
  </div>
  
    <div>
    <div class="quarto-title-meta-heading">Modified</div>
    <div class="quarto-title-meta-contents">
      <p class="date-modified">November 6, 2024</p>
    </div>
  </div>
    
  </div>
  


</header>


<section id="overview" class="level2">
<h2 class="anchored" data-anchor-id="overview">1.0 Overview</h2>
<section id="context" class="level3">
<h3 class="anchored" data-anchor-id="context">1.1 Context</h3>
<p>Of late, housing prices in Singapore have been flying through the roof. Because of this, many Singaporeans who yearn for a private space of their own without breaking the bank have been snapping up properties in neighbouring <a href="https://en.wikipedia.org/wiki/Johor_Bahru">Johor Bahru, Malaysia</a>. How high will this drive property prices in the city, perhaps best known among Singaporeans as a cheap and easily accessible weekend shopping getaway? Compared to Singapore, what factors influence the JB property market? Where is each type of housing, catered to different income levels, clustered? And does it matter that JBâ€™s suburbs lack reliable access to public transport? This project aims to find the answers to these lingering questions and more, through a geospatial analysis on the property market of Johor Bahru and its emerging next-door neighbour, <a href="https://en.wikipedia.org/wiki/Iskandar_Puteri">Iskandar Puteri</a>.</p>
</section>
<section id="objectives" class="level3">
<h3 class="anchored" data-anchor-id="objectives">1.2 Objective(s)</h3>
<ol type="1">
<li>Vanilla and Emerging Hot/cold spot analysis on average/median property values for each Mukim in Johor Bahru and Iskandar Puteri (Pulai)</li>
<li>KDE on selected amenity types (e.g.&nbsp;schools, shopping malls, major transport nodes, commercial districts, industrial districts) in Johor Bahru using data scraped from OpenStreetMap</li>
<li>Building a hedonic pricing model for residential properties in Johor Bahru</li>
</ol>
<p>In this exerciseï¼Œwe will be focusing on building a hedonic pricing model for residential properties in Johor Bahru.</p>
</section>
<section id="the-data-cleaned-and-processed" class="level3">
<h3 class="anchored" data-anchor-id="the-data-cleaned-and-processed">1.3 The Data (cleaned and processed)</h3>
<section id="property-transaction-data-aspatial" class="level4">
<h4 class="anchored" data-anchor-id="property-transaction-data-aspatial">1.3.1 Property Transaction Data (Aspatial)</h4>
<p>We got the Property Transaction Data from <a href="https://napic2.jpph.gov.my/ms/data-transaksi">Portal Pusat Maklumat Harta Tanah Negara (NAPIC)</a></p>
<p>We filter out the relevant data to get and further processed the data by dropping null values. Ensuring workable property data for us to work with.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>property <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/property_transaction_sf_notnull.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="boundary-data-geospatial" class="level4">
<h4 class="anchored" data-anchor-id="boundary-data-geospatial">1.3.2 Boundary Data (Geospatial)</h4>
<p>Johor Bahru, Malaysia boundary data can be downloaded and extracted from <a href="https://www.geoboundaries.org/simplifiedDownloads.html">geoBoundaries</a>.</p>
<p>We filtered out the Mukims (aka district/town - alike the â€˜Toa Payohâ€™, â€˜Punggolâ€™, â€˜Ang Mo Kioâ€™ of Singapore) of Johor Bahru, Malaysia.</p>
<ul>
<li>MUKIM BUKIT BATU</li>
<li>MUKIM SEDENAK</li>
<li>MUKIM KULAI</li>
<li>MUKIM TANJUNG KUPANG</li>
<li>MUKIM PULAI</li>
<li>MUKIM JELUTONG</li>
<li>MUKIM SENAI</li>
<li>BANDAR KULAI</li>
<li>MUKIM TEBRAU</li>
<li>BANDAR JOHOR BAHRU</li>
<li>MUKIM PLENTONG</li>
<li>MUKIM SUNGAI TIRAM</li>
</ul>
<p>We also dropped did data cleaning by dropping columns that we would not be using.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>jb_kulai_bounded <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/jb_kulai_bounded.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="point-of-interest-data-geospatial" class="level3">
<h3 class="anchored" data-anchor-id="point-of-interest-data-geospatial">1.3.3 Point of Interest Data (Geospatial)</h3>
<p>Point of Interest (POI) data can be downloaded from <a href="https://download.geofabrik.de/asia/malaysia-singapore-brunei.html">OpenStreetMap</a>.</p>
<p>From the POI data, we extracted using <a href="https://overpass-turbo.eu/">OSM Overpass Turbo API</a> to extract out POI that might affect housing prices:</p>
<ul>
<li>CUSTOMS_FACILITIES (Only because Singaporeans might consider proximity of houses in JB to the custom when buying a house in JB)</li>
<li>COASTLINES</li>
<li>WATERFRONTS_AND_BEACHES</li>
<li>KINDERGARTENS</li>
<li>SCHOOLS</li>
<li>UNIVERSITIES_AND_COLLEGES</li>
<li>OFFICES,TOWNHALLS</li>
<li>POLICE_AND_FIRE_STATIONS</li>
<li>HOSPITALS_AND_SPECIALISTS</li>
<li>CEMETERY</li>
<li>COMMERCIAL</li>
<li>INDUSTRIAL</li>
<li>PARKS_AND_GREEN_SPACES</li>
<li>THEME_PARKS_AND_RESORTS</li>
<li>BUDDHIST_TEMPLES</li>
<li>CHURCHES</li>
<li>HINDU_TEMPLES</li>
<li>MOSQUES</li>
<li>MARKETPLACE,MALLS</li>
<li>RESTAURANT, CAFE, FAST_FOOD</li>
<li>SUPERMARKET,CONVENIENCE</li>
<li>AIRPORT</li>
<li>BUS_STOPS</li>
<li>BUS_TERMINALS</li>
<li>CARPARKS</li>
<li>PETROL_STATIONS</li>
</ul>
<p>And combining with the <code>property</code> and <code>jb_kulai_bounded</code> data, we get a <code>proximity_matrix</code>, that shows the proximity of the property to each POI.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>proximity_matrix <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/proximity_matrix.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="setup" class="level2">
<h2 class="anchored" data-anchor-id="setup">2.0 Setup</h2>
<p>In this assignment, four R packages will be used, they are:</p>
<ul>
<li><a href="https://r-spatial.github.io/sf/"><strong>sf</strong></a> is use for importing and handling geospatial data in R,</li>
<li><a href="https://www.tidyverse.org/"><strong>tidyverse</strong></a> is mainly use for wrangling attribute data in R,</li>
<li><a href="https://cran.r-project.org/package=sfdep"><strong>sfdep</strong></a> will be used to compute spatial weights, global and local spatial autocorrelation statistics, and</li>
<li><a href="https://cran.r-project.org/web/packages/tmap/index.html"><strong>tmap</strong></a> will be used to prepare cartographic quality chropleth map.</li>
<li><a href=""><strong>ggstatsplot</strong></a> will be used for statistical analysis</li>
<li><a href=""><strong>olsrr</strong></a> will be used for statistical analysis</li>
</ul>
<p>The following code chunk below is used to install and launch the four R packages.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(sf, tidyverse, sfdep, tmap, ggstatsplot, olsrr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="regression" class="level2">
<h2 class="anchored" data-anchor-id="regression">3.0 Regression</h2>
<section id="simple-linear-regression" class="level3">
<h3 class="anchored" data-anchor-id="simple-linear-regression">3.1 Simple Linear Regression</h3>
<p>Firstly, letâ€™s build a simple linear regression model with <code>price_USD</code> as our dependent variable and <code>Land/Parcel Area</code> as our independent variable. To simply test if prices are mainly dependent on the size of the property.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>property_slr <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula=</span>price_USD <span class="sc">~</span> <span class="st">`</span><span class="at">Land/Parcel Area</span><span class="st">`</span>, <span class="at">data =</span> proximity_matrix)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(property_slr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = price_USD ~ `Land/Parcel Area`, data = proximity_matrix)

Residuals:
     Min       1Q   Median       3Q      Max 
-2010856   -29305   -11129    20775   851666 

Coefficients:
                    Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)        59292.436    862.515   68.74   &lt;2e-16 ***
`Land/Parcel Area`   400.173      3.895  102.74   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 64150 on 14864 degrees of freedom
Multiple R-squared:  0.4152,    Adjusted R-squared:  0.4152 
F-statistic: 1.055e+04 on 1 and 14864 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>Note: We can see that p-value is very small, hence, it can be concluded that size of the property is significant in determining the price at which the property is sold, which should come at no surprise.</p>
</blockquote>
</section>
<section id="multiple-linear-regression" class="level3">
<h3 class="anchored" data-anchor-id="multiple-linear-regression">3.2 Multiple Linear Regression</h3>
<p>Now, we would like to test if price of properties in JB are affected by the POIs we identified earlier.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>property_mlr <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula=</span>price_USD <span class="sc">~</span> <span class="st">`</span><span class="at">Land/Parcel Area</span><span class="st">`</span> <span class="sc">+</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>                     PROX_CUSTOMS_FACILITIES <span class="sc">+</span> PROX_COASTLINES <span class="sc">+</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>                     PROX_WATERFRONTS_AND_BEACHES <span class="sc">+</span> PROX_KINDERGARTENS <span class="sc">+</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>                     PROX_SCHOOLS <span class="sc">+</span> PROX_UNIVERSITIES_AND_COLLEGES <span class="sc">+</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>                     <span class="st">`</span><span class="at">PROX_OFFICES,TOWNHALLS</span><span class="st">`</span> <span class="sc">+</span> PROX_POLICE_AND_FIRE_STATIONS <span class="sc">+</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>                     PROX_HOSPITALS_AND_SPECIALISTS <span class="sc">+</span> PROX_CEMETERY <span class="sc">+</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>                     PROX_COMMERCIAL <span class="sc">+</span> PROX_INDUSTRIAL <span class="sc">+</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>                     PROX_PARKS_AND_GREEN_SPACES <span class="sc">+</span> PROX_THEME_PARKS_AND_RESORTS <span class="sc">+</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>                     PROX_BUDDHIST_TEMPLES <span class="sc">+</span> PROX_CHURCHES <span class="sc">+</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>                     PROX_HINDU_TEMPLES <span class="sc">+</span> PROX_MOSQUES <span class="sc">+</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>                     <span class="st">`</span><span class="at">PROX_MARKETPLACE,MALLS</span><span class="st">`</span> <span class="sc">+</span> <span class="st">`</span><span class="at">PROX_RESTAURANT, CAFE, FAST_FOOD</span><span class="st">`</span> <span class="sc">+</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>                     <span class="st">`</span><span class="at">PROX_SUPERMARKET,CONVENIENCE</span><span class="st">`</span> <span class="sc">+</span> PROX_AIRPORT <span class="sc">+</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>                     PROX_BUS_STOPS <span class="sc">+</span> PROX_BUS_TERMINALS <span class="sc">+</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>                     PROX_CARPARKS <span class="sc">+</span> PROX_PETROL_STATIONS, </span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> proximity_matrix)</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(property_mlr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = price_USD ~ `Land/Parcel Area` + PROX_CUSTOMS_FACILITIES + 
    PROX_COASTLINES + PROX_WATERFRONTS_AND_BEACHES + PROX_KINDERGARTENS + 
    PROX_SCHOOLS + PROX_UNIVERSITIES_AND_COLLEGES + `PROX_OFFICES,TOWNHALLS` + 
    PROX_POLICE_AND_FIRE_STATIONS + PROX_HOSPITALS_AND_SPECIALISTS + 
    PROX_CEMETERY + PROX_COMMERCIAL + PROX_INDUSTRIAL + PROX_PARKS_AND_GREEN_SPACES + 
    PROX_THEME_PARKS_AND_RESORTS + PROX_BUDDHIST_TEMPLES + PROX_CHURCHES + 
    PROX_HINDU_TEMPLES + PROX_MOSQUES + `PROX_MARKETPLACE,MALLS` + 
    `PROX_RESTAURANT, CAFE, FAST_FOOD` + `PROX_SUPERMARKET,CONVENIENCE` + 
    PROX_AIRPORT + PROX_BUS_STOPS + PROX_BUS_TERMINALS + PROX_CARPARKS + 
    PROX_PETROL_STATIONS, data = proximity_matrix)

Residuals:
     Min       1Q   Median       3Q      Max 
-1857688   -24926    -5536    16986   962142 

Coefficients:
                                     Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)                        38665.7338  4612.3135   8.383  &lt; 2e-16 ***
`Land/Parcel Area`                   379.6640     3.6426 104.228  &lt; 2e-16 ***
PROX_CUSTOMS_FACILITIES                0.9882     0.2947   3.354 0.000799 ***
PROX_COASTLINES                       -1.4696     0.4069  -3.612 0.000305 ***
PROX_WATERFRONTS_AND_BEACHES          -0.1829     0.3200  -0.572 0.567639    
PROX_KINDERGARTENS                     1.1579     0.4804   2.410 0.015961 *  
PROX_SCHOOLS                           0.5508     1.1075   0.497 0.618931    
PROX_UNIVERSITIES_AND_COLLEGES        -5.5802     0.5205 -10.722  &lt; 2e-16 ***
`PROX_OFFICES,TOWNHALLS`               4.0372     0.4349   9.283  &lt; 2e-16 ***
PROX_POLICE_AND_FIRE_STATIONS          0.3276     0.5479   0.598 0.549938    
PROX_HOSPITALS_AND_SPECIALISTS         3.4832     0.5707   6.103 1.07e-09 ***
PROX_CEMETERY                          3.6972     0.5315   6.956 3.63e-12 ***
PROX_COMMERCIAL                       -9.1703     0.7794 -11.766  &lt; 2e-16 ***
PROX_INDUSTRIAL                        5.1968     0.6592   7.883 3.42e-15 ***
PROX_PARKS_AND_GREEN_SPACES           -3.4699     0.7714  -4.498 6.90e-06 ***
PROX_THEME_PARKS_AND_RESORTS          -3.2876     0.4387  -7.494 7.06e-14 ***
PROX_BUDDHIST_TEMPLES                  2.1807     0.3499   6.232 4.74e-10 ***
PROX_CHURCHES                         -2.6531     0.3104  -8.548  &lt; 2e-16 ***
PROX_HINDU_TEMPLES                    -0.1114     0.4579  -0.243 0.807886    
PROX_MOSQUES                          11.0327     0.9703  11.371  &lt; 2e-16 ***
`PROX_MARKETPLACE,MALLS`               3.8792     0.5230   7.417 1.27e-13 ***
`PROX_RESTAURANT, CAFE, FAST_FOOD`     0.9580     1.2545   0.764 0.445077    
`PROX_SUPERMARKET,CONVENIENCE`        -3.8310     1.3048  -2.936 0.003329 ** 
PROX_AIRPORT                           0.9446     0.2559   3.692 0.000224 ***
PROX_BUS_STOPS                         6.4250     1.1452   5.610 2.06e-08 ***
PROX_BUS_TERMINALS                     1.6876     0.4045   4.172 3.04e-05 ***
PROX_CARPARKS                         -8.2270     1.0397  -7.913 2.69e-15 ***
PROX_PETROL_STATIONS                   6.9497     1.0213   6.805 1.05e-11 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 58720 on 14838 degrees of freedom
Multiple R-squared:  0.5109,    Adjusted R-squared:   0.51 
F-statistic: 574.1 on 27 and 14838 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>Note: Taking alpha at 5%, we can see that <code>PROX_WATERFRONTS_AND_BEACHES</code>, <code>PROX_SCHOOLS</code>, <code>PROX_UNIVERSITIES_AND_COLLEGES</code>, <code>PROX_POLICE_AND_FIRE_STATIONS</code>, <code>PROX_HINDU_TEMPLES</code> and <code>PROX_RESTAURANT, CAFE, FAST_FOOD</code> are not statiscally significant.</p>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>property_new_mlr <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula=</span>price_USD <span class="sc">~</span> <span class="st">`</span><span class="at">Land/Parcel Area</span><span class="st">`</span> <span class="sc">+</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>                     PROX_CUSTOMS_FACILITIES <span class="sc">+</span> PROX_COASTLINES <span class="sc">+</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>                     PROX_KINDERGARTENS <span class="sc">+</span> <span class="st">`</span><span class="at">PROX_OFFICES,TOWNHALLS</span><span class="st">`</span> <span class="sc">+</span> </span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>                     PROX_HOSPITALS_AND_SPECIALISTS <span class="sc">+</span> PROX_CEMETERY <span class="sc">+</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>                     PROX_COMMERCIAL <span class="sc">+</span> PROX_INDUSTRIAL <span class="sc">+</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>                     PROX_PARKS_AND_GREEN_SPACES <span class="sc">+</span> PROX_THEME_PARKS_AND_RESORTS <span class="sc">+</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>                     PROX_BUDDHIST_TEMPLES <span class="sc">+</span> PROX_CHURCHES <span class="sc">+</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>                     PROX_MOSQUES <span class="sc">+</span> <span class="st">`</span><span class="at">PROX_MARKETPLACE,MALLS</span><span class="st">`</span> <span class="sc">+</span> </span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>                     <span class="st">`</span><span class="at">PROX_SUPERMARKET,CONVENIENCE</span><span class="st">`</span> <span class="sc">+</span> PROX_AIRPORT <span class="sc">+</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>                     PROX_BUS_STOPS <span class="sc">+</span> PROX_BUS_TERMINALS <span class="sc">+</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>                     PROX_CARPARKS <span class="sc">+</span> PROX_PETROL_STATIONS, </span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> proximity_matrix)</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a><span class="fu">ols_regress</span>(property_new_mlr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                              Model Summary                                
--------------------------------------------------------------------------
R                           0.712       RMSE                    58903.482 
R-Squared                   0.507       MSE                3474762506.053 
Adj. R-Squared              0.506       Coef. Var                  45.515 
Pred R-Squared              0.492       AIC                    368799.926 
MAE                     33524.912       SBC                    368974.883 
--------------------------------------------------------------------------
 RMSE: Root Mean Square Error 
 MSE: Mean Square Error 
 MAE: Mean Absolute Error 
 AIC: Akaike Information Criteria 
 SBC: Schwarz Bayesian Criteria 

                                     ANOVA                                      
-------------------------------------------------------------------------------
                    Sum of                                                     
                   Squares           DF       Mean Square       F         Sig. 
-------------------------------------------------------------------------------
Regression    5.301289e+13           21      2.524423e+12    726.502    0.0000 
Residual      5.157937e+13        14844    3474762506.053                      
Total         1.045923e+14        14865                                        
-------------------------------------------------------------------------------

                                                 Parameter Estimates                                                  
---------------------------------------------------------------------------------------------------------------------
                         model         Beta    Std. Error    Std. Beta       t        Sig         lower        upper 
---------------------------------------------------------------------------------------------------------------------
                   (Intercept)    29161.994      4375.489                   6.665    0.000    20585.494    37738.494 
            `Land/Parcel Area`      382.102         3.649        0.615    104.705    0.000      374.949      389.255 
       PROX_CUSTOMS_FACILITIES        0.758         0.266        0.058      2.855    0.004        0.238        1.279 
               PROX_COASTLINES       -0.457         0.264       -0.031     -1.731    0.084       -0.975        0.061 
            PROX_KINDERGARTENS       -0.412         0.422       -0.009     -0.976    0.329       -1.240        0.416 
      `PROX_OFFICES,TOWNHALLS`        2.358         0.350        0.056      6.746    0.000        1.673        3.043 
PROX_HOSPITALS_AND_SPECIALISTS        0.915         0.459        0.022      1.995    0.046        0.016        1.815 
                 PROX_CEMETERY        3.377         0.463        0.053      7.295    0.000        2.470        4.285 
               PROX_COMMERCIAL       -8.580         0.767       -0.116    -11.182    0.000      -10.084       -7.076 
               PROX_INDUSTRIAL        4.996         0.644        0.054      7.759    0.000        3.734        6.258 
   PROX_PARKS_AND_GREEN_SPACES       -4.121         0.754       -0.048     -5.469    0.000       -5.598       -2.644 
  PROX_THEME_PARKS_AND_RESORTS       -3.802         0.336       -0.238    -11.324    0.000       -4.461       -3.144 
         PROX_BUDDHIST_TEMPLES        1.738         0.332        0.043      5.241    0.000        1.088        2.388 
                 PROX_CHURCHES       -1.695         0.287       -0.070     -5.909    0.000       -2.257       -1.133 
                  PROX_MOSQUES       11.483         0.920        0.100     12.481    0.000        9.680       13.286 
      `PROX_MARKETPLACE,MALLS`        2.430         0.480        0.049      5.061    0.000        1.489        3.370 
`PROX_SUPERMARKET,CONVENIENCE`       -2.133         0.978       -0.020     -2.180    0.029       -4.051       -0.216 
                  PROX_AIRPORT        1.434         0.250        0.122      5.728    0.000        0.943        1.925 
                PROX_BUS_STOPS        8.499         1.102        0.066      7.710    0.000        6.338       10.660 
            PROX_BUS_TERMINALS        1.454         0.398        0.030      3.655    0.000        0.674        2.233 
                 PROX_CARPARKS       -8.105         1.027       -0.064     -7.895    0.000      -10.118       -6.093 
          PROX_PETROL_STATIONS        6.086         0.943        0.062      6.454    0.000        4.237        7.934 
---------------------------------------------------------------------------------------------------------------------</code></pre>
</div>
</div>
</section>
</section>
<section id="proposed-shiny-application-user-interface-storyboard" class="level2">
<h2 class="anchored" data-anchor-id="proposed-shiny-application-user-interface-storyboard">4.0 Proposed Shiny Application User Interface Storyboard</h2>
<p>After determining the variables that we is affecting the price of JB property for Singaporean buyer. We can start thinking of how the user is able to see the expected prices of the properties, while toggling through different POIs. As everyone look out for different things when buying a property.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="picture/UI storyboard.jpg" class="img-fluid figure-img"></p>
<figcaption>Figure 1: UI Storyboard</figcaption>
</figure>
</div>
<p>The user would be able to toggle between District (Mukim), Type of Property and POIs, with the added option of their budget and house area size.</p>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
District (Mukim)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li>MUKIM BUKIT BATU</li>
<li>MUKIM SEDENAK</li>
<li>MUKIM KULAI</li>
<li>MUKIM TANJUNG KUPANG</li>
<li>MUKIM PULAI</li>
<li>MUKIM JELUTONG</li>
<li>MUKIM SENAI</li>
<li>BANDAR KULAI</li>
<li>MUKIM TEBRAU</li>
<li>BANDAR JOHOR BAHRU</li>
<li>MUKIM PLENTONG</li>
<li>MUKIM SUNGAI TIRAM</li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Type of Property
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li>1 - 1 1/2 Storey Semi-Detached</li>
<li>1 - 1 1/2 Storey Terranced</li>
<li>2 - 2 1/2 Storey Semi-Detached</li>
<li>2 - 2 1/2 Storey Terranced</li>
<li>Cluster House</li>
<li>Condominium/Apartment</li>
<li>Detached</li>
<li>Flat</li>
<li>Low-Cost Flat</li>
<li>Low-cost House</li>
<li>Town House</li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
POIs options
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li>CUSTOMS_FACILITIES</li>
<li>COASTLINES</li>
<li>KINDERGARTENS</li>
<li>OFFICES,TOWNHALLS</li>
<li>HOSPITALS_AND_SPECIALISTS</li>
<li>CEMETERY</li>
<li>COMMERCIAL</li>
<li>INDUSTRIAL</li>
<li>PARKS_AND_GREEN_SPACES</li>
<li>THEME_PARKS_AND_RESORTS</li>
<li>BUDDHIST_TEMPLES</li>
<li>CHURCHES</li>
<li>MOSQUES</li>
<li>MARKETPLACE,MALLS</li>
<li>SUPERMARKET,CONVENIENCE</li>
<li>AIRPORT</li>
<li>BUS_STOPS</li>
<li>BUS_TERMINALS</li>
<li>CARPARKS</li>
<li>PETROL_STATIONS</li>
</ul>
</div>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "î§‹";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>